<f:layout name="default" />

<f:section name="mainbox">
	<f:if condition="{posts}">
		<f:then>
			<div id="navigation">
				<span class="buttons"><f:link.action action="new" controller="Post" arguments="{blog: blog}"><img src="{f:uri.resource('Icons/FamFamFam/page_add.png')}" title="Create a new post"/></f:link.action></span>
				<div class="clear"></div>
			</div>
			<ol class="posts">
				<f:for each="{posts}" as="post">
					<li class="post">
						<h2>
							<f:link.action action="show" controller="Post" arguments="{post: post, blog: post.blog}">{post.title}</f:link.action>
						</h2>
						<p class="metadata">
							Published on <f:format.date format='d.m.Y'>{post.date}</f:format.date> by {post.author}
							<f:link.action action="show" controller="Post" arguments="{post: post, blog: post.blog}" section="comments"><img src="{f:uri.resource('Icons/FamFamFam/comments.png')}" title="Comments"/>
								<f:if condition="{post.numberOfComments} > 0">
									<f:then>{post.numberOfComments} comments</f:then>
									<f:else>No comments</f:else>
								</f:if>
							</f:link.action>	
						</p>
						<p class="content"><f:format.crop maxCharacters="500">{post.content}</f:format.crop> <f:link.action action='show' arguments='{post: post, blog: post.blog}'>More</f:link.action></p>
					</li>
				</f:for>
			</ol>
		</f:then>
		<f:else>
			<p>This blog currently doesn't contain any posts. ﻿<f:link.action action="new" controller="Post" arguments="{blog: blog}">Create the first post</f:link.action></p>
		</f:else>
	</f:if>
</f:section>